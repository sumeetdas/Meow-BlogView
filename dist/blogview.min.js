angular.module("meow.blog.view",["ui.router","blogViewTemplates","ngSanitize","hc.marked","djds4rce.angular-socialshare","angularUtils.directives.dirDisqus"]).config(["$stateProvider",function(e){e.state("blog",{"abstract":!0,views:{blogView:{controller:"BlogViewCtrl",templateUrl:"blog-view.base.tpl.html"}},resolve:{meta:["$http","$FB",function(e,t){return e({method:"GET",url:"/api/meta"}).then(function(e){e=e.data||{};var r=e.angularSocialShare||{};return r&&r.facebook&&"string"==typeof r.facebook.appId&&t.init(r.facebook.appId),{blogsPerPage:e.blogsPerPage||5,username:e.username||"John Doe",tags:e.tags||[],disqus:e.disqus||{},angularSocialShare:e.angularSocialShare||{}}})}]}}).state("blog.list",{url:"/blogs",views:{main:{controller:"BlogViewListCtrl",templateUrl:"blog-view.list.tpl.html"}}}).state("blog.list.tag",{url:"/tags/:tag",views:{main:{controller:"BlogViewListCtrl",templateUrl:"blog-view.list.tpl.html"}}}).state("blog.list.query",{url:"/query/:query",views:{main:{controller:"BlogViewListCtrl",templateUrl:"blog-view.list.tpl.html"}}}).state("blog.view",{url:"/blogs/posts/:year/:month/:date/:slug",views:{main:{controller:"BlogViewPostCtrl",templateUrl:"blog-view.post.tpl.html"},side:{controller:"BlogViewPostSideCtrl",templateUrl:"blog-view.post.side.tpl.html"}}})}]),angular.module("meow.blog.view").config(["$locationProvider",function(e){e.html5Mode(!0).hashPrefix("!")}]).service("$blogView",["$http",function(e){function t(e){if(e)if("string"==typeof e)try{e=parseInt(e)}catch(t){e=1}else"number"!=typeof e&&(e=1);else e=1;var r=u.length;return r?parseInt(r/e)+(r%e===0?0:1):1}function r(r,l,s){e.get("/api/blogs/tags/"+r).success(function(e){u=e,c=t(s),g=1,"function"==typeof l&&l(u.slice(0,s))}).error(console.error)}function l(r,l,s){e.get("/api/blogs/query/"+r).success(function(e){u=e,c=t(s),g=1,"function"==typeof l&&l(u.slice(0,s))}).error(console.error)}function s(r,l){e.get("/api/blogs").success(function(e){u=e,c=t(l),g=1,"function"==typeof r&&r(u.slice(0,l))}).error(console.error)}function o(t,r){e.get("/api/blogs/posts/"+t.year+"/"+t.month+"/"+t.date+"/"+t.slug).success(function(e){r(e)}).error(console.error)}function a(e,t){g>1&&(g-=1,e(u.slice((g-1)*t,g*t)))}function n(e,t){c>g&&(g+=1,e(u.slice((g-1)*t,g*t)))}function i(e){if("string"!=typeof e)throw new Error("pFileName is not a string");var t=e.split("-"),r=t.shift(),l=t.shift(),s=t.shift(),o=t.join("-"),a=["January","February","March","April","May","June","July","August","September","October","November","December"];return{year:r,month:l,date:s,slug:o,formattedDate:a[l-1]+" "+parseInt(s)+", "+r}}var g=1,c=1,u=[];return{getCurrentPageNo:function(){return g},getPageCount:function(){return c},getBlogsByTag:r,getBlogsByQuery:l,getBlogs:s,getBlog:o,getPrevBlogs:a,getNextBlogs:n,parseFileName:i}}]),angular.module("meow.blog.view").directive("post",["$compile","marked",function(e,t){return{restrict:"A",replace:!0,link:function(r,l,s){r.$watch(s.post,function(s){s&&"string"==typeof s&&0!==s.length&&(l.html(t(s)),e(l.contents())(r))})}}}]),angular.module("meow.blog.view").controller("BlogViewListCtrl",["$scope","$blogView","$state","meta",function(e,t,r,l){e.username=l.username,l.angularSocialShare=l.angularSocialShare||{},l.angularSocialShare.twitter=l.angularSocialShare.twitter||{},e.twitterHandle=l.angularSocialShare.twitter.handle||"",e.$on("$stateChangeSuccess",function(){r.params.tag?t.getBlogsByTag(r.params.tag,function(t){e.blogs=t},l.blogsPerPage):r.params.query?t.getBlogsByQuery(r.params.query,function(t){e.blogs=t},l.blogsPerPage):t.getBlogs(function(t){e.blogs=t},l.blogsPerPage)}),e.next=function(){t.getNextBlogs(function(t){e.blogs=t},l.blogsPerPage)},e.prev=function(){t.getPrevBlogs(function(t){e.blogs=t},l.blogsPerPage)},e.isFirstPage=function(){return 1===t.getCurrentPageNo()},e.isLastPage=function(){return t.getCurrentPageNo()===t.getPageCount()},e.getFormattedDate=function(e){return e&&e.fileName?t.parseFileName(e.fileName).formattedDate:""},e.goToBlog=function(e){var l=t.parseFileName(e.fileName);r.go("blog.view",{year:l.year,month:l.month,date:l.date,slug:l.slug})}}]).controller("BlogViewPostCtrl",["$scope","$stateParams","$blogView","$location","meta",function(e,t,r,l,s){r.getBlog({year:t.year,month:t.month,date:t.date,slug:t.slug},function(t){e.blog=t}),e.getFormattedDate=function(e){return e&&e.fileName?r.parseFileName(e.fileName).formattedDate:""},e.username=s.username,s.disqus=s.disqus||{},e.disqus={shortname:s.disqus.shortname,id:l.url(),url:l.absUrl()}}]).controller("BlogViewPostSideCtrl",[function(){}]).controller("BlogViewCtrl",["$blogView","$scope","$state",function(e,t,r){t.search=function(){r.go("blog.list.query",{query:t.query})}}]),angular.module("blogViewTemplates",[]).run(["$templateCache",function(e){e.put("blog-view.base.tpl.html",'<div class="container">\r\n    <div class="row">\r\n        <div class="col-lg-7 col-lg-offset-2 col-md-12 blog-main" ui-view="main"></div>\r\n        <div class="col-lg-3 col-md-6 col-sm-12 col-xs-12" style="margin-top: 15px;">\r\n            <div class="row">\r\n                <div class="col-lg-8 col-md-6 col-sm-6 col-xs-6">\r\n                    <input type="text" class="form-control" ng-model="query" placeholder="Type your query here" ng-keypress="$event.keyCode === 13 ? search() : angular.noop()">\r\n                </div>\r\n                <div class="col-lg-4 col-md-6 col-sm-6 col-xs-6 center-block">\r\n                    <button class="btn btn-default center-block" ng-click="search()" title="Search {{query ? \'\\\'\' + query + \'\\\'\' : \'something\'}}">Search</button>\r\n                </div>\r\n            </div>\r\n            <hr>\r\n            <div ui-view="side"></div>\r\n        </div>\r\n    </div>\r\n    <div class="row" style="margin-top: 15px; margin-bottom: 15px;">\r\n        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">\r\n            <p style="font-size: medium">Powered by <a href="https://github.com/sumeetdas1992/Meow" target="_blank">Meow</a></p>\r\n        </div>\r\n    </div>\r\n</div>'),e.put("blog-view.list.tpl.html",'<div>\r\n    <div ng-repeat="blog in blogs">\r\n        <div class="post-preview" ng-if="blogs">\r\n            <a href="#" ng-click="goToBlog(blog);">\r\n                <h2 class="post-title">\r\n                    {{blog.title}}\r\n                </h2>\r\n                <h3 class="post-subtitle" ng-if="blog.subtitle">\r\n                    {{blog.subtitle}}\r\n                </h3>\r\n            </a>\r\n            <div class="post-meta">Posted by <a ng-href="/#!/blogs">{{username}}</a> on {{getFormattedDate(blog)}}</div>\r\n            <div class="post-meta">\r\n                <span class="glyphicon glyphicon-tags text-info" style="margin-right:5px;"></span>\r\n                <em ng-repeat="tag in blog.tags"><a class="tag-link" ng-href="/#!/blogs/tags/{{tag}}">{{tag}}</a>{{$last ? \'\' : \', \'}}</em>\r\n            </div>\r\n        </div>\r\n        <!--<div class="post-preview" ng-if="blogs === [] || !blogs">\r\n            <h2>No blogs</h2>\r\n        </div>-->\r\n        <hr>\r\n    </div>\r\n    <ul class="pager">\r\n        <li class="previous">\r\n            <a href="#" ng-if="!isFirstPage()" ng-click="prev()">Previous</a>\r\n        </li>\r\n        <li class="next">\r\n            <a href="#" ng-if="!isLastPage()" ng-click="next()">Next</a>\r\n        </li>\r\n    </ul>\r\n</div>'),e.put("blog-view.post.side.tpl.html",""),e.put("blog-view.post.tpl.html",'<div class="post-preview">\r\n    <h1 class="post-title">{{blog.title}}</h1>\r\n\r\n    <h3 ng-if="blog.subtitle" class="post-subtitle">{{blog.subtitle}}</h3>\r\n\r\n    <div post="blog.post"></div>\r\n\r\n    <br>\r\n\r\n    <div class="post-meta">Posted by <a ng-href="/#!/blogs">{{username}}</a> on {{getFormattedDate(blog)}}</div>\r\n    <div class="post-meta">\r\n        <span class="glyphicon glyphicon-tags text-info" style="margin-right:5px;"></span>\r\n        <em ng-repeat="tag in blog.tags">\r\n            <a class="tag-link" ng-href="/#!/blogs/tags/{{tag}}" style="margin-left:5px;">{{tag}}</a>{{$last ? \'\' : \', \'}}\r\n        </em>\r\n    </div>\r\n\r\n    <br>\r\n\r\n    <div class="row">\r\n        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6" style="margin-top: -5px;">\r\n            <a facebook class="facebookShare" data-url=\'{{disqus.url}}\' data-shares=\'shares\'>{{ shares }}</a>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">\r\n            <a twitter data-lang="en" data-count=\'horizontal\' data-url=\'{{disqus.url}}\' data-via=\'{{twitterHandle}}\' data-size="medium" data-text=\'{{blog.title}}\' ></a>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">\r\n            <div gplus class="g-plus" data-size="tall" data-annotation="bubble" data-href=\'{{disqus.url}}\' data-action=\'share\'></div>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">\r\n            <div linkedin class="linkedinShare" data-url=\'{{disqus.url}}\' data-title=\'{{blog.title}}\' data-summary="testing Linkedin Share" data-shares=\'linkedinshares\'>{{linkedinshares}}</div>\r\n        </div>\r\n    </div>\r\n\r\n    <br>\r\n\r\n    <dir-disqus disqus_shortname="{{disqus.shortname}}" disqus_identifier="{{disqus.id}}" disqus_url="{{disqus.url}}"></dir-disqus>\r\n\r\n</div>')}]);